

# SPDX-FileCopyrightText: Copyright (c) 2025, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

general:
  use_uvloop: true
  logging:
    console:
      _type: console
      level: WARN

  front_end:
    _type: fastapi

  front_end:
    _type: console



# functions:
#   current_datetime:
#     _type: current_datetime
#   road_info:
#     _type: mcp_tool_wrapper
#     description: "获取中国城市道路信息. 关于道路交通信息和分析，请使用此工具!"
#     url: "http://127.0.0.1:9901/mcp/call"   # 你的 MCP 服务器地址
#     transport: "streamable-http"
#     mcp_tool_name: road-info      # 服务器里暴露的 tool 名
#     description: "分析用户上传的道路图像..."
#     timeout_ms: 30000
#     # headers:
#     #   Authorization: Bearer ${MCP_TOKEN}   # 可选：如果需要鉴权就配
#     # 如果你的框架支持为工具声明入参结构，可以加上（可选）：
#     input_schema:
#       type: object
#       properties:
#         image_path: 
#           type: string
#           description: "http://127.0.0.1:9901/2025-05-17_15:52:02.jpg"
#         roi:
#           type: array
#           items: number
#           minItems: 4
#           maxItems: 4
#           description: 可选，矩形 [x1,y1,x2,y2]
#       required: [image_path]

functions:
  road_info:
    _type: mcp_tool_wrapper
    url: "http://127.0.0.1:9901/mcp"
    transport: "streamable-http"
    mcp_tool_name: image_analyzer_tool



llms:
  # 默认使用Bailian API (用户可修改)
  nim_llm:
    _type: openai
    model_name: "qwen-plus"
    api_key: "sk-624c20dbecac4a41913f1e66e83ea1ec"
    base_url: "https://dashscope.aliyuncs.com/compatible-mode/v1"
    temperature: 0.7
    max_tokens: 2048

embedders:
  nv-embedqa-e5-v5:
    _type: nim
    model_name: nvidia/nv-embedqa-e5-v5

# workflow:
#   _type: react_agent
#   tool_names: [current_datetime, road_info]
#   llm_name: nim_llm
#   verbose: true
#   parse_agent_response_max_retries: 3

workflow:
  _type: react_agent
  tool_names: [road_info]
  llm_name: nim_llm
# workflow:
#   _type: react_agent
#   parameter: default_value
